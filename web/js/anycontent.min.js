/*! anycontent 2019-07-05 */

function cmck_modal_id(e,t,n){e="#"+e,$(e).off("shown.bs.modal"),$(e).on("shown.bs.modal",function(){"function"==typeof n&&n()}),void 0!==t&&($(e).removeData(),$(e+" .modal-header").html(""),$(e+" .modal-body").html(""),$(e+" .modal-footer").html("")),$(e).appendTo("body"),$(e).modal({keyboard:!0}),$(e).load(t)}function cmck_modal(e,t){cmck_modal_id("modal_edit",e,t)}function cmck_modal_id_hide(e){e="#"+e,$(e).modal("hide")}function cmck_modal_hide(){cmck_modal_id_hide("modal_edit")}function cmck_modal_set_property(e,t){$("#form_edit [name="+e+"]").val(t)}function cmck_set_var(e,t){"object"!=typeof $.cmck&&($.cmck={}),$.cmck[e]=t}function cmck_get_var(e,t){return $.cmck[e]}function cmck_trigger_change(n){$(n).trigger("change"),$("iframe").each(function(e,t){"function"==typeof t.contentWindow.cmck_sequence_trigger_change&&t.contentWindow.cmck_sequence_trigger_change(n)})}function cmck_message_info(e){$("#messages").html('<div class="alert alert-info">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_alert(e){$("#messages").html('<div class="alert alert-warning">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_message_error(e){$("#messages").html('<div class="alert alert-danger">'+e+"</div>"),$(document).scrollTop(0),$("#messages div").delay(3e3).fadeOut(500)}function cmck_get_cookie(e){var t=window.document.cookie.split(e+"=");if(2==t.length)return t.pop().split(";").shift()}function cmck_delete_cookie(e){document.cookie=encodeURIComponent(e)+"=deleted; expires="+new Date(0).toUTCString()}function cmck_document(){return document}$(document).ready(function(){$(".button_delete").click(function(){var t=$(this).attr("href");return bootbox.confirm("Are you sure?",function(e){e&&(document.location=t)}),!1})}),$(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":$(".formelement-popover").popover({html:!0}),$(".formelement-tooltip").popover({html:!0})}}),$(document).ready(function(){}),$(document).ready(function(){$("#form_files_button_create_folder").click(function(){return $("#modal_files_create_folder").modal({}),!1}),$("#form_files_button_upload_file").click(function(){return $("#modal_files_upload_file").modal({}),!1}),$("#form_files_button_delete_folder").click(function(){return $("#modal_files_delete_folder").modal({}),!1}),$(".files-file-zoom").click(function(){$("#modal_files_file_zoom_title").html($(this).attr("data-title")),$("#modal_files_file_zoom_iframe").attr("src",$(this).attr("href"));return $("#modal_files_file_zoom").modal({keyboard:!0}),!1}),$(".files-file-edit").click(function(){$("#modal_files_file_original_id").val($(this).attr("data-title")),$("#modal_files_file_rename_id").val($(this).attr("data-title"));return $("#modal_files_file_edit").modal({keyboard:!0}),!1}),$(".files-delete-file").click(function(){$("#modal_files_file_delete_title").html($(this).attr("data-title")),$("#modal_files_file_delete_id").val($(this).attr("data-title"));return $("#modal_files_delete_file").modal({keyboard:!0}),!1})}),$(document).ready(function(){$(".feedback .alert-success").delay(2e3).fadeOut(500),$(".feedback .alert-info").delay(2500).fadeOut(500),$(".feedback .alert-warning").delay(3e3).fadeOut(500),$(".feedback .alert-danger").delay(4500).fadeOut(500),$(".timeshift-blink").each(function(){var e=$(this);setInterval(function(){"hidden"==e.css("visibility")?e.css("visibility","visible"):e.css("visibility","hidden")},500)})}),$(document).ready(function(){$("#listing_filter select").change(function(){$("#listing_filter").submit()})}),$(document).ready(function(){$("ol.sortable-tree").nestedSortable({handle:"div",items:"li.sortable-item",toleranceElement:"> div",protectRoot:!0,opacity:.5,revert:250,tabSize:10,tolerance:"pointer",connectWith:".sortable-tree"}),$("#form_sort_button_save").click(function(){$("ol.sortable-tree").nestedSortable({items:"li"}),nested=$("ol.sortable-tree").nestedSortable("toArray",{startDepthCount:-1}),tree=[],$.each(nested,function(e,t){if(0<t.depth){var n={id:t.item_id,parent_id:t.parent_id};tree.push(n)}}),$.blockUI({message:null}),$("#form_sort_list").val(JSON.stringify(tree))})}),function(n){n(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":n(".datepicker").each(function(){n(this).datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",showWeek:!1,firstDay:1,numberOfMonths:1,showButtonPanel:!1})})}})}(jQuery),function(a){a.fn.cmck_fe_email=function(){var n=function(e){if(a(this).removeClass("alert-success"),a(this).removeClass("alert-danger"),email=a(this).val(),""!=email){var t=a(this);n=email,/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)?(t.addClass("alert-success"),t.removeClass("alert-danger")):(t.addClass("alert-danger"),t.removeClass("alert-success"))}var n};a(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":a("div.formelement-email input").each(function(){val=a(this).val(),a(this).on("focus",n),a(this).on("blur",n)})}})},a(document).cmck_fe_email()}(jQuery),$(document).ready(function(){$("#listing_button_import").click(function(){return cmck_modal($(this).attr("href")),!1}),$("#listing_button_export").click(function(){return cmck_modal($(this).attr("href")),!1})}),function(a){a(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":a(".formelement-file-modal-button").off(),a(".formelement-file-modal-button").click(function(){var e=a(a(this).attr("data-input"));return parent.cmck_set_var("fe_file_property",e),parent.cmck_modal(a(this).attr("href")),!1}),a(".formelement-file-modal-button-view").off(),a(".formelement-file-modal-button-view").click(function(){var e=a(this).attr("data-input"),t=a(e).val();a(parent.document).find("#modal_files_file_zoom_title").html(t);var n=a(e).attr("data-url-view")+t;return a(parent.document).find("#modal_files_file_zoom_iframe").attr("src",n),a.ajax({url:n,type:"HEAD"}).always(function(e){null!=e&&404==e.status?alert("File not found. Please check file path."):parent.cmck_modal_id("modal_files_file_zoom"),parent.cmck_modal_id("modal_files_file_zoom")}),!1}),a(".formelement-file-modal-button-download").off(),a(".formelement-file-modal-button-download").click(function(){var e=a(this).attr("data-input"),t=a(e).val();return""!=t.trim()&&(t=a(this).attr("href")+t,a.ajax({url:t,type:"HEAD"}).always(function(e){if(null==e||404!=e.status)return window.location.href=t,!1;alert("File not found. Please check file path.")})),!1}),a(".formelement-file input, .formelement-image input").on("change",function(){var e="#"+a(this).attr("id")+"_preview",t=a(this).val();if(a(e).hide(),a(e+" a").attr("href",""),a(e+" img").attr("src",""),t&&null!=t.toLowerCase().match(/\.(jpeg|jpg|gif|png)$/)){var n=a(this).attr("data-url-view")+t;a.ajax({url:n,type:"HEAD",error:function(){a(e).hide()},success:function(){a(e).show(),a(e+" a").attr("href",n),a(e+" img").attr("src",n)}})}})}})}(jQuery),function(a){a(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":a(".formelement-geolocation-modal-button").off(),a(".formelement-geolocation-modal-button").click(function(){var e=a(a(this).attr("data-input")+"_lat").val(),t=a(a(this).attr("data-input")+"_long").val(),n=a(this).attr("href")+"/"+e+"/"+t;return parent.cmck_modal(n),!1})}})}(jQuery),function(a){a.fn.cmck_fe_link=function(){var n=function(e){if(a(this).removeClass("alert-success"),a(this).removeClass("alert-danger"),url=a(this).val(),""!=url){var t=a(this);a.ajax({url:"/edit/check/link/"+url,success:function(e){t.removeClass("alert-success"),t.removeClass("alert-warning"),t.removeClass("alert-danger"),200==e?t.addClass("alert-success"):400<e?t.addClass("alert-danger"):t.addClass("alert-warning")}})}};a(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":a("div.formelement-link input").each(function(){a(this).off("blur"),a(this).on("blur",n)})}})},a(document).cmck_fe_link()}(jQuery),function(n){n(document).on("cmck",function(e,t){switch(t.type){case"editForm.init":case"sequenceForm.init":case"sequenceForm.refresh":n(".formelement-password input[type=text]").each(function(){n(this).change(function(){n(this).next("input[type=hidden]").val(1)})}),n(".formelement-password-generate-button").each(function(){n(this).click(function(){target=n(this).attr("data-target"),n(target).val(Math.random().toString(36).slice(-8)),n(target).next("input[type=hidden]").val(1)})}),n(".formelement-password-clear-button").each(function(){n(this).click(function(){target=n(this).attr("data-target"),n(target).val(""),n(target).next("input[type=hidden]").val(1),alert("Password cleared.")})})}})}(jQuery),function(e){e(".formelement-reference select").on("change",function(){value=e(this).val(),button=e("#"+e(this).attr("id")+"_edit_button"),""!=value?(e(button).removeClass("disabled"),url=e(button).attr("data-url"),console.log(url),url=url.replace("recordId",value),e(button).attr("href",url)):e(button).addClass("disabled")})}(jQuery),$(function(){$.widget("custom.autocompleteCat",$.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items","> :not(.ui-autocomplete-category)")},_renderMenu:function(a,e){var o=this,i="";$.each(e,function(e,t){var n;t.category!=i&&(void 0!==t.category&&a.append("<li class='ui-autocomplete-category'>"+t.category+"</li>"),i=t.category),n=o._renderItemData(a,t),t.category&&n.attr("aria-label",t.category+" : "+t.label)})}})}),$(document).ready(function(){$(document).on("cmck",function(e,t){switch(t.type){case"editform.Save":$(".sequence-iframe").each(function(){var t=$(this).contents().find("#form_sequence");$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))+1),$.post($(t).attr("action"),$(t).serialize(),function(e){$("#form_edit").attr("data-event-countdown",parseInt($("#form_edit").attr("data-event-countdown"))-1),$.event.trigger("cmck",{type:"editform.setProperty",property:$(t).attr("data-property"),value:JSON.stringify(e.sequence),save:!0})},"json")})}})}),function(s){s.fn.cmck_fe_table=function(){var r=function(){s(".formelement-table tbody").sortable({handle:".handle"}),s(".formelement-table td").click(function(){s(this).children("textarea").focus()}),s(".formelement-table a[data-action=plus]").click(function(){var e=i(this),t=c(this);return l(t,e),!1}),s(".formelement-table a[data-action=minus]").click(function(){var e=i(this),t=c(this);return n(t,e),!1}),s(".formelement-table textarea").keydown(function(e){if(9===e.keyCode){var t=s(this).closest("tr").nextAll().length,n=s(this).closest("td").nextAll().length;if(0==t&&1==n){var a=i(this),o=c(this);l(o,a)}}}),s(".formelement-table table").each(function(e){a(s(this).attr("name"))})},i=function(e){var t=s(e).closest("table"),n=s(e).closest("tr"),a=s(t).find("tr");return s(a).index(n)},c=function(e){var t=s(e).closest("table");return s(t).attr("name")},l=function(e,t){var n=parseInt(s("table[name="+e+"]").attr("data-rows"));s("table[name="+e+"]").attr("data-rows",++n);var a=s("table[name="+e+"] th").length-2,o='<tr><td class="handle" width="2%">'+n+"</td>";o+=Array(a+1).join('<td><textarea name="'+e+'[]"></textarea></td>'),o+='<td width="3%"><a class="btn btn-default btn-xs" href="#" tabindex="-1" data-action="plus">+</button></a>  <a class="btn btn-default btn-xs" href="#" tabindex="-1" data-action="minus">-</button></a></td></tr>';var i=s("table[name="+e+"]").find("tr");row=i[t],s(row).after(o),s(".formelement-table a").off(),r()},n=function(e,t){var n=s("table[name="+e+"]").find("tr");row=n[t],s(row).remove(),a(e)},a=function(e){var t=s("table[name="+e+"] a[data-action=minus]");s(t).each(function(e){s(this).show()}),1==t.length&&s(t[0]).hide()};s(document).on("cmck",function(e,t){t.type}),r()},s(document).ready(function(){s(document).cmck_fe_table()})}(jQuery);